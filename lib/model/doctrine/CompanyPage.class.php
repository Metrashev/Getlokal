<?php

/**
 * CompanyPage
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    getLokal
 * @subpackage model
 * @author     Get Lokal
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class CompanyPage extends BaseCompanyPage
{
	public function getPrimaryAdmin() {

	$q = Doctrine::getTable ( 'PageAdmin' )->createQuery ( 'p' )
	->where ( 'p.page_id = ?', $this->getId () )	
	->andWhere ( 'p.status = ?','approved' )
	->andWhere ( 'p.is_primary = ?', true );

	return $q->fetchOne(); 
	}
   public function getPageAdminbyUserId($user_id) {
		$q = Doctrine::getTable ( 'PageAdmin' )
		->createQuery ( 'p' )
		->innerjoin ( 'p.CompanyPage cp' )		
		->where ( 'cp.page_id = ?', $this->getId () )
		->andWhere ( 'p.user_id = ?', $user_id )
		->andWhere ( 'p.status = ?', 'approved' );
		$admin = $q->fetchOne ();
		
		return $admin;
	}
}
