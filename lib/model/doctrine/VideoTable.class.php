<?php

/**
 * VideoTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class VideoTable extends ImageTable
{
    /**
     * Returns an instance of this class.
     *
     * @return object VideoTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('Video');
    }
public  static function getObjectByCompanyId($company_id)
    {
 	
 	$query = Doctrine_Core::getTable ( 'Video' )
 	->createQuery ( 'co1' )
 	->innerJoin('co1.CompanyImage co2')
 	 ->leftJoin('co1.CompanyProductVideo cp1')
      ->where('co2.company_id = ?', $company_id);
           
      $q3 = $query->createSubquery ()->select ( 'cpo.foreign_id' )
            ->from ( 'CompanyProductVideo cpo' )
            ->innerJoin('cpo.Video v')
            ->innerJoin('v.CompanyImage co')
            ->andWhere ( 'co.company_id = ' . $company_id );
      
         $q4 = $query->createSubquery ()->select ( 'c.image_id' )
      ->from ( 'Company c' )     
      ->andWhere('c.id = '. $company_id );    
            
    $query->andWhere ( 'co1.id NOT IN (' . $q3->getDql () . ')' );  
    $query->andWhere ( 'co1.id NOT IN (' . $q4->getDql () . ')' );
     
      $videos = $query->execute();
      
     
     return $videos; 
 }
}